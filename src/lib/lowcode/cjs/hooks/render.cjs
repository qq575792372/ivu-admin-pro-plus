"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const a=require("vue"),G=require("@vue/composition-api"),A=require("./global.cjs"),$=require("./widget.cjs");function N({props:s}){const{executeGlobalEvent:v,executeGlobalAction:f}=A.default({props:s}),{getPropValue:b}=$.default({props:s});let r=null;const h=a.computed(()=>s.widgets),u=a.computed(()=>s.globalConfig),m=function(n,l){let e={};for(let t in l.props)e[t]=b(l.props[t],n);return e},p=function(n,l){let e={};for(let t of l.events||[]){let c=`on${t.name.charAt(0).toUpperCase()+t.name.slice(1)}`,i=["// 执行组件绑定的自定义事件"];if(t.code&&i.push(t.code),t.action){let g=t.action.filter(o=>o.includes("$globalActions")).map(o=>`this.executeGlobalAction('${o.split(".")[1]}');`),x=t.action.filter(o=>!o.includes("$globalActions")).map(o=>`this.$refs.${o&&o.split(".")[0]} && this.$refs.${o}();`);i=i.concat(`
// 执行组件绑定的全局动作代码`).concat(g).concat(`
// 执行组件绑定的组件动作方法`).concat(x)}e[c]=new Function(t.args,i.join(`
`)).bind(n),console.log("events[eventName]",e[c])}return e},d=function(n,l){return l.map(e=>{let t=a.resolveComponent(e.type+"-widget"),c=m(n,e),i=p(n,e);return a.h(t,{ref:e.id,widget:e,...c,...i},{default:()=>d(n,e.widgets)})})};return G.defineComponent({mounted(){r=this,this.executeGlobalEvent("onMounted",this)},updated(){this.executeGlobalEvent("onUpdated",this)},unmounted(){this.executeGlobalEvent("onUnmounted",this)},beforeMount(){this.executeGlobalEvent("onBeforeMount",this)},beforeUpdate(){this.executeGlobalEvent("onBeforeUpdate",this)},beforeUnmount(){this.executeGlobalEvent("onBeforeUnmount",this)},activated(){this.executeGlobalEvent("onActivated",this)},deactivated(){this.executeGlobalEvent("onDeactivated",this)},methods:{executeGlobalEvent:n=>v(u.value.globalEvents,n,r,u.value.globalVars),executeGlobalAction:n=>f(u.value.globalActions,n,r,u.value.globalVars)},render(){return a.h("div",{},{default:()=>d(this,h.value)})}})}exports.default=N;
